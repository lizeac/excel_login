<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Dashboard de RelatÃ³rios</title>
</head>
<body>
    <h1>Dashboard de RelatÃ³rios</h1>

    <form method="get">
        <label for="ano">Escolha o Ano:</label>
        <select name="ano" id="ano">
            <option value="todos">Todos</option>
            {% for ano in anos_disponiveis %}
                <option value="{{ ano }}" {% if ano_selecionado and ano|stringformat:"s" == ano_selecionado|stringformat:"s" %}selected{% endif %}>
                    {{ ano }}
                </option>
            {% endfor %}
        </select>

        <label for="mes">Escolha o MÃªs:</label>
        <select name="mes" id="mes">
            <option value="todos">Todos</option>
            {% for numero, nome in meses_disponiveis %}
                <option value="{{ numero }}" {% if numero == mes_selecionado %}selected{% endif %}>
                    {{ nome }}
                </option>
            {% endfor %}
        </select>

        <button type="submit">Filtrar</button>
    </form>
    {% load extras %}
    {% if registros %}
    <h2>Registros:</h2>
    <ul>
        {% for registro in registros %}
            <li>{{ registro.nome_completo }} â€“ {{ registro.data_acesso|date:"d \\d\\e F \\d\\e Y" }}</li>
        {% empty %}
            <li>Nenhum registro encontrado.</li>
        {% endfor %}
    </ul>

    <hr>

    <h2>Resumo de Dados</h2>

    <h3>ğŸ“Š Dados Gerais</h3>
    <ul>
        <li>Total de acessos: {{ dados_gerais.total_acessos }}</li>
        <li>Total de visitantes: {{ dados_gerais.total_visitantes }}</li>
        <li>Total de usuÃ¡rios UFBA: {{ dados_gerais.total_usuario_ufba }}</li>
    </ul>

    <h3>ğŸ‘¥ UsuÃ¡rio(s) mais assÃ­duo(s)</h3>
    <ul>
        {% for usuario in usuario_assiduo %}
            <li>{{ usuario.nome_completo }} â€” {{ usuario.total }} acesso(s)</li>
        {% endfor %}
    </ul>

    <h3>ğŸ“ Curso mais frequente</h3>
    <p>
        {% if curso_frequente.curso %}
            {{ curso_frequente.curso }} â€“ {{ curso_frequente.total }} acesso(s)
        {% else %}
            Nenhum curso encontrado.
        {% endif %}
    </p>

    <h3>ğŸ› ï¸ ServiÃ§o mais utilizado</h3>
    <p>
        {% if servico_frequente.servico %}
            {{ servico_frequente.servico }} â€“ {{ servico_frequente.total }} uso(s)
        {% else %}
            Nenhum serviÃ§o encontrado.
        {% endif %}
    </p>

    <h3>ğŸ“… Dia da semana com maior fluxo</h3>
    <p>
        {% if max_dia_semana.dia_da_semana %}
            {{ max_dia_semana.dia_da_semana }} â€“ {{ max_dia_semana.total }} acesso(s)
        {% else %}
            Nenhum dia encontrado.
        {% endif %}
    </p>


    <h3>ğŸ“ˆ MÃ©dia de acessos por dia da semana</h3>

    <ul>
        {% for valor in media_dia_semana %}
            <li>{{ dias_ordenados|index:forloop.counter0 }}: {{ valor }}</li>
        {% endfor %}
    </ul>

    <h3>ğŸ•— MÃ©dia de acessos por hora</h3>
    <ul>
        {% for hora, media in media_horas.items %}
            <li>{{ hora }}h: {{ media }}</li>
        {% endfor %}
    </ul>

    <h3>ğŸ“Š GrÃ¡fico: MÃ©dia de acessos por hora</h3>
    {% if grafico_hora %}
        <img src="{{ grafico_hora_url }}" alt="GrÃ¡fico por hora" style="max-width: 100%; height: auto;">
    {% endif %}

    <h3>ğŸ“Š GrÃ¡fico: MÃ©dia de acessos por semana</h3>
    {% if grafico_semana %}
        <img src="{{ grafico_semana_url }}" alt="GrÃ¡fico por semana" style="max-width: 100%; height: auto;">
    {% endif %}
    {% endif %}

</body>
</html>
